{% load cms_tags %}

<article
  {# class="c-article-preview c-article-preview--..." #}
  {{ instance.attributes_str }}
>
  {# Media e.g. image thumbnail #}
  {# HACK: Forced to use a wrapper because we cannot control markup #}
  <div class="c-article-preview__media">
  {% for plugin_instance in instance.child_plugin_instances %}
      {% render_plugin plugin_instance %}
  {% endfor %}
  </div>

  {# Title #}
  <h3 class="c-article-preview__title">
    <a class="c-article-preview__link" href="{{ link_url }}"
      {% if link_target %}target="{{ link_target }}"{% endif %}>
      {{ instance.title_text }}
    </a>
  </h3>

  {# Abstract #}
  {% if kind != 'allocs' %}
  <p class="c-article-preview__abstract">
    {{ instance.abstract_text }}
  </p>
  {% endif %}

  {# Metadata #}
  <ul class="c-article-preview__metadata">



  {# Date #}

  {% if kind == 'news' %}
    <li class="c-article-preview__date  c-date">
      <span class="c-date__label">Published</span>
      <time class="c-date__value" datetime="{{ open_date|date:"Y-m-d" }}">
        {{ open_date|date:"F d, Y" }}
      </time>
    </li>
  {% endif %}

  {% if kind == 'allocs' %}

    {% if open_date and close_date and open_date <= close_date %}

    <li class="c-article-preview__date  c-date">
      <span class="c-date__label">Submission Dates</span>
      <time class="c-date__value"
            datetime="{{ open_date|date:"Y-m-d" }}">
        {{ open_date|date:"M d, Y" }}
      </time>
      <span>â€”</span>
      <time class="c-date__value"
            datetime="{{ close_date|date:"Y-m-d" }}">
        {{ close_date|date:"M d, Y" }}
      </time>
    </li>

    {% elif should_show_open_date %}

    <li class="c-article-preview__date  c-date">
      <span class="c-date__label">
      {# FAQ: Odd spacing avoids whitespace rendered after text #}
      {% if open_date_time_period == 'future' %}
          Submissions Next Open{% else %}Submissions Open Since{% endif %}</span>
      <time class="c-date__value" datetime="{{ open_date|date:"Y-m-d" }}">
        {{ open_date|date:"F d, Y" }}
      </time>
    </li>

    {% elif should_show_close_date %}

    <li class="c-article-preview__date  c-date">
      <span class="c-date__label">
        {# FAQ: Odd spacing avoids whitespace rendered after text #}
        {% if open_date_time_period == 'future' %}
            Submissions Deadline{% else %}Submissions Closed{% endif %}</span>
      <time class="c-date__value" datetime="{{ close_date|date:"Y-m-d" }}">
        {{ close_date|date:"F d, Y" }}
      </time>
    </li>

    {% endif %}

  {% endif %}



  {# Type #}
  {% if kind == 'news' %}
    <li class="c-article-preview__type">{{ instance.type_text }}</li>
  {% endif %}

  {# Author #}
  {# FAQ: Not shown in design #}
  {% comment %}
    <li class="c-article-preview__author">{{ instance.author_text }}</li>
  {% endcomment %}



  </ul>

</article>
