/*
Header

Styles for elements within a header that has third-party code:

- FontAwesome icons
  (for Portal navigation)
- Bootstrap
  (for CMS navigation)
  (for Portal navigation)
- a subset of Bootstrap 3.3.7
  (for CMS body content, can affect navigation)

Portal & Docs Selectors:

- To select old markup by using subsite-specific selectors, some styles target Portal or Docs. This was necessary because markup changed in CMS during GH-101, but Portal and Docs markup was not updated. If Portal and Docs markup matches that of CMS, then these selectors need not be so specific for _this_ purpose.
- To overwrite Bootstrap by using extra-specific selectors, some styles target Portal or Docs. This was necessary because Bootstrap on both subsites load _after_ these styles (thus took precedence). If we load Bootstrap styles before CMS styles, then these selectors need not be so specific for _this_ purpose.

Markup: s-header.html.twig

Styleguide Trumps.Scopes.Header
*/
@import url("_imports/tools/selectors.css");
@import url("_imports/tools/x-arrow.css");
@import url("_imports/tools/x-truncate.css");

/* RFE: Make Portal & Docs markup match CMS (see "Portal & Docs Selectors") */
/* RFE: Load Bootstrap before CMS stylesheets (see "Portal & Docs Selectors") */



/* Generic */

/* .s-header, *//* FAQ: Already inherited from body */
/* To match CMS line-height */
:--for-docs .s-header,
:--for-portal .s-header {
  line-height: 1.4;
}





/* Nav Bar */

@custom-selector :--nav-bar-fake-bkgd  .s-header.navbar::after;

.s-header.navbar {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--bold);
  font-family: env(--header-font-family);

  /* Copied from Portal (via `body`) */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* To color navbar, but allow CMS nav to be transluscent to body content */
:--nav-bar-fake-bkgd {
  content: '';

  position: absolute;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;

  background-color: env(--header-bkgd-color);
}

/* To overwrite Bootstrap */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar {
  padding: 0;
}

/* To stretch elements as tall as parent */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar,
/* To propogate styles through extra wrapper (of Bootstrap-driven mobile nav) */
.s-header .navbar-collapse {
  align-items: stretch;
}

/* To prevent zero-height element as it is loaded */
/* FAQ: The zero-height fix is most obvious on Portal/Docs or slow network */
/* To prevent extra height from FOUC during Portal/Docs AJAX content load */
/* To set nav height, but not constrain height of opened mobile nav */
/* FAQ: Set height of descendants, but not of CMS and Portal and mobile navs */
:--nav-bar-fake-bkgd,
#header-logo,
.s-header :--navbar-button,
.s-header tacc-search-bar {
  /* FAQ: To allow height to change in `…expanded.css` and `…compressed.css` */
  height: var(--header-navbar-height, env(--header-navbar-normal-height));
}





/* Branding */

.s-header.c-branding,
/* To apply style to old markup (see "Portal & Docs Selectors") */
/* NOTE: The old markup is dynamically replaced by new markup from CMS */
:--for-docs .branding-header,
:--for-portal .branding-header {
  /* To prevent zero-height element as it is loaded */
  height: var(--header-brandbar-height, env(--header-brandbar-normal-height));

  color: var(--global-color-primary--xx-light);
  background-color: var(--global-color-primary--xx-dark);
  border-bottom: 1px solid var(--global-color-primary--xx-light);
}





/* Logo */

#header-logo {
  /* To allow projects to change value and responsive design to use value */
  --space-after-logo-before-nav: 25px;

  display: flex;
  align-items: center;

  /* To allow shrinking beyond content width */
  min-width: 0;

  /* To overwrite Bootstrap */
  margin-right: var(--space-after-logo-before-nav);

  /* To align logo (whole image not just visible pixels) with Portal sidebar */
  margin-left: calc(
    env(--portal-sidebar-padding) + env(--portal-navlink-padding)
  );

  /* FAQ: In case image does not load and browser shows alt text */
  color: env(--header-text-color);
}
/* To overwrite Bootstrap */
#header-logo.navbar-brand {
  padding-top: unset;
  padding-bottom: unset;
}

#header-logo .c-logo__image {
  padding-top: 5px;
  padding-bottom: 5px;

  /* Of base i.e. container */
  /* To avoid a project shrinking logo beyond legibility */
  min-height: 50%;
  min-width: 50%;
}





/* Nav */



/* Container */

.s-header .navbar-nav {
  /*
  --nav-link-horz-pad: …
  --nav-line-color: …
  */
}



/* Toggle */

@custom-selector :--navbar-button
  .navbar-toggler;
@custom-selector :--navbar-button--opened
  .navbar-toggler[aria-expanded="true"];
@custom-selector :--navbar-button--closed
  .navbar-toggler[aria-expanded="false"];

/* Button */
.s-header :--navbar-button {
  /* display: flex; *//* SEE `s-header.compressed.css` */
  flex-direction: column;
  align-items: center;
  justify-content: center;

  width: env(--header-navbar-toggle-width);
  margin-right: env(--header-navbar-toggle-width);
  padding: 0; /* to overwrite Bootstrap */

  color: env(--header-text-color);
  background-color: env(--header-portal-nav-bkgd-color);

  /* To overwrite Bootstrap */
  border: none;
  border-radius: 0;
}

/* Icon */
.s-header :--navbar-button::before {
  font-size: 30px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
}
/* To overwrite Bootstrap */
.s-header .navbar-toggler-icon { display: none; }
/* To swap Bootstrap icon for Cortal icon */
/* HACK: To apply icon styles without using a class in the markup */
/* FAQ: For dynamic markup change, Portal & Docs markup must be updated */
/* SEE: https://getbootstrap.com/docs/4.0/components/collapse/#events */
.s-header :--navbar-button { @extend [class*=" icon-"]; }
.s-header :--navbar-button::before { @extend .icon; }
/* To change icon without using dynamic icon classes */
.s-header :--navbar-button--opened { @extend .icon-close; }
.s-header :--navbar-button--closed { @extend .icon-burger; }
/* To stretch icon to mimic icon in design (which is not available yet) */
.s-header :--navbar-button--closed::before { transform: scaleX(1.5); }

/* Text */
.s-header :--navbar-button::after {
  content: attr(data-icon-label);
  display: block;

  font-family: Benton Sans, env(--header-font-family);
  font-size: 10px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  text-align: center;
  text-transform: uppercase;
  font-weight: env(--medium);
}
.s-header :--navbar-button--opened::after { display: none; }



/* Nav Links */

/* RFE: Fix bug on the Internet so we can use these reliably */
/* SEE: https://github.com/postcss/postcss-custom-selectors/issues/40 */
/*
@custom-selector :--nav-link-hover  .nav-link:hover;
@custom-selector :--nav-link-focus  .nav-link:focus;
@custom-selector :--nav-link-active .nav-link:active;
@custom-selector :--nav-link-current
  .nav-item.active .nav-link,
  .nav-item.dropdown.show .nav-link;
*/

.s-header .nav-link {
  /* To support truncation */
  /* To vertically center text and icons (if any) */
  display: flex;
  align-items: center;
}

/* To truncate link text */
/* SEE: https://css-tricks.com/flexbox-truncated-text/ */
.s-header .s-cms-nav,
.s-header .nav-item { min-width: 0; }
.s-header .nav-text { @extend .x-truncate--one-line; }

/* NOTE: Design may want hover & active background color with alpha */
.s-header .nav-link:hover,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link,
.s-header .nav-item.dropdown.show .nav-link {
  background-color: env(--header-link-bkgd-color);
}

/* NOTE: Design may want hover/focus/active styles the same for any nav state */
/* SEE: `./s-header.compressed.css` */
/* SEE: `./s-header.expanded.css` */

/* FAQ: Comment out `.navbar-dark` to obviate "Portal & Docs Selectors" here */
/* FAQ: On CMS, the `.navbar-dark` is a descendant of `.s-header` */
.s-header/* .navbar-dark */ .nav-link,
.s-header/* .navbar-dark */ .nav-link:focus,
.s-header/* .navbar-dark */ .nav-link:hover {
  color: env(--header-text-color) !important;
}

/* FAQ: The overspecific `.navbar-nav` selector allows overwrite of Bootstrap */
.s-header .navbar-nav .nav-link,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-portal .s-header .navbar-nav .nav-link {
  padding-right: var(--nav-link-horz-pad, 0);
  padding-left: var(--nav-link-horz-pad, 0);
}

/* To create line between each item */
.s-header .nav-item + .nav-item .nav-link {
  /* To ensure any background color does not cover box-shadow */
  position: relative;

  box-shadow:
    /* x pos. */ calc(var(--nav-link-horz-pad) / 2)
    /* y pos. */ calc(-1 * (2px + calc(var(--nav-link-horz-pad) / 2)))
    /* blur */   0
    /* spread */ calc(-1 * calc(var(--nav-link-horz-pad) / 2))
    /* color */  var(--nav-line-color, transparent);
}





/* Dropdowns */



/* Container */

.s-header .dropdown {
  /*
  --menu-link-horz-pad: …
  --menu-line-color: …
  */
}



/* Toggle */

.s-header .dropdown-toggle::after {
  @extend %x-arrow;

  --size: 0.5em;
  --line: 0.1em; /* to get 1px at 12px text and 2px at 24px text */
  --color: env(--header-text-color);

  margin-left: 0.6em;
  position: relative; /* to allow use of `top` (to vertically align) */
}
.s-header .dropdown-toggle[aria-expanded="true"]::after {
  @extend %x-arrow--up;
  top: 0.35em; /* to vertically align with text */
}
.s-header .dropdown-toggle[aria-expanded="false"]::after {
  @extend %x-arrow--down;
  top: -0.35em; /* to vertically align with text */
}



/* Menu */

.s-header .dropdown-menu {
  margin: unset; /* undo Bootstrap */

  border-radius: unset; /* undo Bootstrap */
}



/* Item */

/* FAQ: Selector specificty trumps Bootstrap, so no need for `:hover` (etc.) */
.s-header .dropdown-item {
  padding-left: var(--menu-link-horz-pad);
  padding-right: var(--menu-link-horz-pad);

  border-left: env(--border-width--x-thick) solid transparent;

  font-weight: env(--medium);
}
.s-header .dropdown-item + .dropdown-item {
  box-shadow:
    /* x pos. */ 0
    /* y pos. */ calc(-1 * (1px + var(--menu-link-horz-pad)))
    /* blur */   0
    /* spread */ calc(-1 * var(--menu-link-horz-pad))
    /* color */  var(--menu-line-color, transparent);
}

.s-header .dropdown-item.active,
.s-header .dropdown-item:active,
.s-header .dropdown-item:focus,
.s-header .dropdown-item:hover {
  border-left-color: env(--header-accent-color);
  background-color: env(--header-bkgd-color);
  box-shadow: none;
}

.s-header .dropdown-item,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-portal .s-header .dropdown-item.active,
:--for-portal .s-header .dropdown-item:active,
:--for-portal .s-header .dropdown-item:focus,
:--for-portal .s-header .dropdown-item:hover {
  color: env(--header-text-color);
}


/* Search */

/* GH-101: Retain search design until Wes works on it */
.s-header .s-search-bar,
.s-header .s-search-bar::part(input),
.s-header .s-search-bar::part(button) {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
}

/* Create space between search bar and login (only if both elements exist) */
.s-header .s-search-bar ~ .s-portal-nav {
  margin-left: 12px;
}





/* Icons */

.s-header .dropdown-item .nav-icon {
  margin-right: 0.5em;
}
