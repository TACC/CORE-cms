/*
Header

Styles for elements within a header that has third-party code:

- FontAwesome icons
  (for Portal navigation)
- Bootstrap
  (for CMS navigation)
  (for Portal navigation)
- a subset of Bootstrap 3.3.7
  (for CMS body content, can affect navigation)

Portal & Docs Selectors:

- To select old markup by using subsite-specific selectors, some styles target Portal or Docs. This was necessary because markup changed in CMS during GH-101, but Portal and Docs markup was not updated. If Portal and Docs markup matches that of CMS, then these selectors need not be so specific for _this_ purpose.
- To overwrite Bootstrap by using extra-specific selectors, some styles target Portal or Docs. This was necessary because Bootstrap on both subsites load _after_ these styles (thus took precedence). If we load Bootstrap styles before CMS styles, then these selectors need not be so specific for _this_ purpose.

Markup: s-header.html.twig

Styleguide Trumps.Scopes.Header
*/
@import url("_imports/tools/selectors.css");
@import url("_imports/tools/x-arrow.css");

/* RFE: Make Portal & Docs markup match CMS (see "Portal & Docs Selectors") */
/* RFE: Load Bootstrap before CMS stylesheets (see "Portal & Docs Selectors") */





/* Nav Bar */

.s-header.navbar {
  background-color: env(--header-bkgd-color);

  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--bold);
  font-family: env(--header-font-family);

  /* Copied from Portal (via `body`) */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* To give cross-site padding that respects Portal-specific visual balance */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar {
  /* To align logo (whole image not just visible pixels) with Portal sidebar */
  /* FAQ: The calc() retains values from disparate styles in Portal */
  /* FAQ: The calc() is calculated at build time, so we may be verbose */
  /*      - 16px is 1rem from Portal `#sidebar .nav-content` */
  /*      - 20px is from Portal `.nav-link` */
  padding: 0 calc(16px + 20px);
}

/* To stretch elements as tall as parent */
.s-header.navbar,
/* To overwrite Bootstrap (see "Portal & Docs Selectors") */
:--for-docs .s-header.navbar,
:--for-portal .s-header.navbar,
/* To propogate styles through extra wrapper (of Bootstrap-driven mobile nav) */
.s-header .navbar-collapse {
  align-items: stretch;
}

/* To prevent zero-height element as it is loaded */
/* FAQ: The zero-height fix is most obvious on Portal/Docs or slow network */
/* To prevent extra height from FOUC during Portal/Docs AJAX content load */
/* To set nav height, but not constrain height of opened mobile nav */
/* FAQ: Set height of descendants, but not of CMS and Portal and mobile navs */
.s-header .c-logo,
.s-header .navbar-toggler,
.s-header tacc-search-bar {
  height: env(--header-navbar-height);
}





/* Branding */

.s-header.c-branding,
/* To apply style to old markup (see "Portal & Docs Selectors") */
/* NOTE: The old markup is dynamically replaced by new markup from CMS */
:--for-docs .branding-header,
:--for-portal .branding-header {
  /* To prevent zero-height element as it is loaded */
  height: env(--header-brandbar-height);

  color: var(--global-color-primary--xx-light);
  background-color: var(--global-color-primary--xx-dark);
  border-bottom: 1px solid var(--global-color-primary--normal);
}





/* Logo */

.s-header .c-logo {
  /* To allow projects to set this value, but let Core implement it */
  --width: auto;
  width: var(--width);

  /* To prevent zero-width element as it is loaded */
  /* To align position of first CMS nav link with Portal section headers */
  min-width: 190px; /* CAVEAT: Only works for logos narrow enough to fit */

  /* To allow projects to set this value, but let Core implement it */
  --space-after-logo-before-nav: 0;
  margin-right: var(--space-after-logo-before-nav); /* overwrites Bootstrap */

  /* FAQ: In case image does not load and browser shows alt text */
  color: env(--header-text-color);
}
/* To overwrite bootstrap */
.s-header .c-logo.navbar-brand {
  padding-top: unset;
  padding-bottom: unset;
  display: unset;
}

.s-header .c-logo__image {
  padding-top: 5px;
  padding-bottom: 5px;
}





/* Nav Links */

/* RFE: Fix bug on the Internet so we can use these reliably */
/* SEE: https://github.com/postcss/postcss-custom-selectors/issues/40 */
/*
@custom-selector :--nav-link-hover  .s-header .nav-link:hover;
@custom-selector :--nav-link-focus  .s-header .nav-link:focus;
@custom-selector :--nav-link-active .s-header .nav-link:active;
@custom-selector :--nav-link-current
  .s-header .nav-item.active .nav-link,
  .s-header .nav-item.dropdown.show .nav-link;
*/

.s-header .nav-link {
  height: 100%;

  display: flex;
  align-items: center;
  /* FAQ: If link text uses 2 lines, header grows taller, but it must not */
  white-space: nowrap;
}
.s-header .nav-link:hover,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link,
.s-header .nav-item.dropdown.show .nav-link {
  background-color: env(--header-link-bkgd-color);
}
.s-header .nav-link:hover,
.s-header .nav-link:focus,
.s-header .nav-link:active,
.s-header .nav-item.active .nav-link,
.s-header .nav-item.dropdown.show .nav-link {
  border-top: env(--border-width--xx-thick) solid transparent;
  border-bottom: env(--border-width--xx-thick) solid env(--header-accent-color);
}

/* To overwrite Bootstrap */
.s-header .nav-link {
  padding-top: unset;
  padding-bottom: unset;
}
/* FAQ: Comment out `.navbar-dark` to obviate "Portal & Docs Selectors" here */
/* FAQ: On CMS, the `.navbar-dark` is a descendant of `.s-header` */
.s-header/* .navbar-dark */ .nav-link,
.s-header/* .navbar-dark */ .nav-link:focus,
.s-header/* .navbar-dark */ .nav-link:hover {
  color: env(--header-text-color) !important;
}

/* To set less space between nav links when screen is narrow */
@media (--wide-and-above) {
  .s-header .navbar-nav .nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal .s-header .navbar-nav .nav-link {
    padding-right: 1.25em; /* intent is 15px padding for 12px font */
    padding-left: 1.25em; /* intent is 15px padding for 12px font */
  }
}
@media (--wide-and-below) {
  .s-header .navbar-nav .nav-link,
  /* To overwrite Bootstrap (see "Portal & Docs Selectors") */
  :--for-portal .s-header .navbar-nav .nav-link {
    padding-right: 0.5em; /* intent is just very narrow (dev design) */
    padding-left: 0.5em; /* intent is just very narrow (dev design) */
  }
}

.s-header .dropdown-toggle::after {
  @extend %x-arrow;

  --size: 4px;
  --line: 1px;
  --color: env(--header-text-color);
  margin-left: 8px;
}
.s-header .dropdown-toggle[aria-expanded="true"]::after {
  @extend %x-arrow--up;
  margin-top: 0.6em;
}
.s-header .dropdown-toggle[aria-expanded="false"]::after {
  @extend %x-arrow--down;
  margin-top: -0.4em;
}





/* Dropdown Menus */

.s-header .dropdown-menu {
  padding: 7px 0 0;
  margin: unset; /* undo Bootstrap */

  background-color: env(--header-link-bkgd-color);
  border: env(--border-width--normal) solid env(--header-accent-color);
  border-radius: unset; /* undo Bootstrap */
}
/* FAQ: Selector specificty trumps Bootstrap, so no need for `:hover` (etc.) */
.s-header .dropdown-item {
  --horz-pad: 11px;
  padding: 5px var(--horz-pad) 6px;

  color: env(--header-text-color);
  border-left: env(--border-width--x-thick) solid transparent;

  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
  font-weight: env(--medium);
}
.s-header .dropdown-item + .dropdown-item {
  box-shadow:
    0px calc(-1 * (1px + var(--horz-pad))) 0px calc(-1 * var(--horz-pad))
    env(--header-bkgd-color);
}
.s-header .dropdown-item.active,
.s-header .dropdown-item:active,
.s-header .dropdown-item:focus,
.s-header .dropdown-item:hover {
  border-left-color: env(--header-accent-color);
  background-color: env(--header-bkgd-color);
  box-shadow: none;
}






/* Search */

/* GH-101: Retain search design until Wes works on it */
.s-header .s-search-bar,
.s-header .s-search-bar::part(input),
.s-header .s-search-bar::part(button) {
  font-size: 12px; /* WARNING: Do not use `rem` until `html { 62.5%; }` */
}

/* Create a line between search bar and login */
/* FAQ: The line should only exist if both elements are present */
.s-header .s-search-bar ~ .s-portal-nav {
  border-left: 1px solid env(--header-minor-border-color);

  margin-left: 12px;
}





/* Icons */

/* HACK: Using FontAwesome as placeholder */
.s-header [class*="fa-"] {
    width: 27px; /* (from Portal `.fa` 1.25em which FP-636 will deprecate) */
    text-align: center;
}
