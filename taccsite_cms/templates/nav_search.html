{% load staticfiles %}
{# @var className #}

{# Encapsulate search bar as custom element, so styles do not bleed out #}
<tacc-search-bar class="s-search-bar  {{className}}"></tacc-search-bar>

{# WARNING: Some markup is duplicated in other repositories #}
{# SEE: https://confluence.tacc.utexas.edu/x/LoCnCQ #}
<template id="tacc-search-bar">
  <style type="text/css">
    /* Hide form before CSS load (to be shown after CSS load) to avoid FOUC */
    form {
      display: none;
    }
  </style>

  {# Include Standard Assets #}
  {# SEE: base.html #}

  <!-- Site Font and/or Custom Font. -->
  {% include 'assets_font.html' %}
  {# WARNING: Custom font MIGHT NOT load; this is untested #}

  <!-- Site Assets. -->
  {% include 'assets_site.html' %}

  <!-- Custom Assets. -->
  <!-- (UNAVAILABLE) -->
  {# WARNING: The `assets_custom` WILL NOT load; the reason is unclear #}
  {# FAQ: Custom project styling can be done per element via `::part()` #}

  {# / Include Standard Assets #}

  {# NOTE: Copied from Portal Data Files search bar (rendered not raw markup) #}
  {# SEE: https://github.com/TACC/Frontera-Portal/blob/master/client/src/components/DataFiles/DataFilesSearchbar/DataFilesSearchbar.js #}
  <form part="form">
    <div class="input-group">
      <div class="input-group-prepend">
        <button part="button" type="submit" class="btn btn-secondary">
          <i part="button__icon" class="icon icon-search" role="img" aria-label=""></i>
          <span class="">Search</span>
        </button>
      </div>
      <input part="input" type="search" name="query" aria-label="Search the website" class="form-control" placeholder="Search the website" data-testid="input" autocomplete="off" value="">
    </div>
  </form>

  {# Include Standard Assets #}
  {# SEE: base.html #}

  <!-- Site Assets (Delayed). -->
  {# !!!: This causes an error (commenting bootstrap.js load resolves error) #}
  {% include 'assets_site_delayed.html' %}

  <!-- Custom Assets (Delayed). -->
  <!-- (UNAVAILABLE) -->
  {# WARNING: The `assets_custom` WILL NOT load; the reason is unclear #}
  {# FAQ: Custom project styling can be done per element via `::part()` #}

  {# / Include Standard Assets #}

</template>

{# <script src="{% static 'site_cms/js/site.tacc-search-bar.js' %}"></script> #}
{# {% comment %} #}
<script>
  let template = document.querySelector("#tacc-search-bar");

  window.customElements.define(template.id, class extends HTMLElement {
    constructor() {
      super();
      console.debug(template);
      this.attachShadow({ mode: "open" });
      this.shadowRoot.appendChild(template.content);
    }
  });
</script>
{# {% endcomment %} #}
